% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gearcalib.R
\name{gearcalib_fit}
\alias{gearcalib_fit}
\title{Non-parametric relative selectivity log-Gaussian Cox process model}
\usage{
gearcalib_fit(
  d,
  fit0 = FALSE,
  logsd = NA,
  phi = NA,
  logsdnug = NA,
  logsdres = NA,
  logsdGearRW = NA,
  logalpha = 0,
  logtheta = NA,
  logitpi = NA,
  model = "poisson"
)
}
\arguments{
\item{d}{A list containing input data with elements:
\itemize{
  \item \code{N}: Matrix of counts (hauls x size bins).
  \item \code{SweptArea}: Numeric vector of swept areas per haul.
  \item \code{group}: Factor indicating group membership.
  \item \code{Gear}: Factor indicating gear type.
  \item \code{Lvec} (optional): Numeric vector of size bin indices (defaults to \code{1:ncol(d$N)} if missing).
}}

\item{fit0}{Logical; if \code{TRUE}, fits a reduced model with no gear size structure and performs a likelihood ratio test.}

\item{logsd}{Optional numeric value to fix the standard deviation (log-scale) of the random walk increments.}

\item{phi}{Optional numeric value to fix the AR(1) correlation parameter.}

\item{logsdnug}{Optional numeric value to fix the standard deviation (log-scale) of the nugget effect.}

\item{logsdres}{Optional numeric value to fix the standard deviation (log-scale) of the residuals.}

\item{logsdGearRW}{Optional numeric value to fix the standard deviation (log-scale) of the gear random walk.}

\item{logalpha}{Optional numeric value to fix the exponent of the swept area effect (default is 0).}

\item{logtheta}{Optional numeric value to fix the overdispersion parameter for negative binomial and ZIP models.}

\item{logitpi}{Optional numeric value to fix the logit of the zero-inflation probability for the ZIP model.}

\item{model}{Character; model to use. One of \code{"poisson"}, \code{"nb"}, or \code{"zip"}. Note that zip and nb are not stable.}
}
\value{
An object of class \code{"gearcalibFit"} containing:
  \item{d}{Input data list.}
  \item{Pvalue}{P-value from likelihood ratio test (if \code{fit0 = TRUE}), otherwise \code{NA}.}
  \item{rep}{TMB \code{sdreport} object containing estimated parameters and standard deviations.}
  \item{opt}{Optimization results from \code{nlminb}.}
  \item{obj}{TMB objective function.}
  \item{est}{Estimated gear effect sizes.}
  \item{sd}{Standard deviations of the gear effect estimates.}
}
\description{
Estimates the relative selectivity ratio following Thygesen et al. (2019), can use a ZIP or negative binomial instead of a Poisson.
}
\details{
Model and code adapted from Thygesen et al. (2019; https://github.com/Uffe-H-Thygesen/Intercalibration).
}
\references{
Thygesen, U.H., Kristensen, K., Jansen, T., Beyer, J.E., 2019. Intercalibration of survey methods using paired fishing operations and log-Gaussian Cox processes. ICES J. Mar. Sci. 76, 1189â€“1199. https://doi.org/10.1093/icesjms/fsy191
}
